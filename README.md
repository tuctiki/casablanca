# Casablanca

A YouTube transcript reader and summarizer.

## Features

- Fetches YouTube video transcripts.
- Summarizes transcripts using the Gemini API.
- Modular design for easy extension and maintenance.

## Installation

1.  **Clone the repository:**

    ```bash
    git clone https://github.com/your-username/casablanca.git
    cd casablanca
    ```

2.  **Install Poetry:**

    Follow the instructions on the [Poetry website](https://python-poetry.org/docs/#installation) to install Poetry.

3.  **Install dependencies:**

    ```bash
    poetry install
    ```

4.  **Activate the virtual environment:**

    ```bash
    poetry shell
    ```

## API Key Setup

This project uses the Gemini API for summarization and YouTube Data API for video metadata and transcripts. You need to set up your API keys and optionally, your Obsidian vault path:

1.  Obtain a Gemini API key from [Google AI Studio](https://aistudio.google.com/app/apikey).
2.  Obtain a YouTube Data API key from [Google Cloud Console](https://console.cloud.google.com/apis/credentials).
3.  Create a file named `.env` in the root directory of the project.
4.  Add your API keys and Obsidian vault path (if you use Obsidian) to the `.env` file in the following format:

    ```
    GEMINI_API_KEY=YOUR_GEMINI_API_KEY_HERE
    YOUTUBE_API_KEY=YOUR_YOUTUBE_API_KEY_HERE
    OBSIDIAN_VAULT_PATH=/path/to/your/obsidian/vault
    ```

    Replace `YOUR_GEMINI_API_KEY_HERE` and `YOUR_YOUTUBE_API_KEY_HERE` with your actual API keys. The `OBSIDIAN_VAULT_PATH` is optional; if not set, the summaries will not be moved to an Obsidian vault.

## Usage

To run the application and summarize a YouTube video transcript:

```bash
python -m casablanca.main <youtube_video_url> [--force] [--expert-prompt <"custom prompt">] [--market-prompt <"custom prompt">] [--categories <"cat1,cat2,cat3">] [--log-level <LEVEL>]
```

Example:

```bash
python -m casablanca.main https://www.youtube.com/watch?v=erI6k_hnToE --force --expert-prompt "Summarize expert opinions concisely." --categories "Tech,Finance" --log-level DEBUG
```

`--log-level` can be one of `DEBUG`, `INFO`, `WARNING`, `ERROR`, `CRITICAL`.

To see all available options, run:

```bash
python -m casablanca.main --help
```

## Output

The application will create an `outputs` directory in the project root. Inside this directory, a new folder will be created for each video, named after the video's ID. The output for each video will be saved in the following structure:

```
outputs/
└───<video_id>/
    ├───transcript.txt
    ├───expert_summary.md
    └───market_summary.md
```

## Running Tests

To run the unit tests for the project, you can use `tox`. This will create isolated environments and run tests against them.

1.  **Install tox:**

    ```bash
    pip install tox
    ```

2.  **Run tests:**

    ```bash
    tox
    ```

Alternatively, you can run `pytest` directly:

```bash
pytest
```

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## Acknowledgements

All code in this project was generated by the Gemini CLI.